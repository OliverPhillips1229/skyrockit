<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Your Applications</title>
  </head>
  <body>
  <%- include('../partials/_navbar.ejs') %>
  <h1>Your Applications</h1>
  <a href="/users/<%=user._id%>/applications/new">Add a New Application</a>
  
  <% if (applications.length === 0) { %>
    <p>No applications yet. <a href="/users/<%=user._id%>/applications/new">Add your first application!</a></p>
  <% } else { %>
    <ul>
      <% applications.forEach(function(application) { %>
        <li>
          <h3><%= application.title %> at <%= application.company %></h3>
          <p>Status: <%= application.status %></p>
          <% if (application.notes) { %>
            <p>Notes: <%= application.notes %></p>
          <% } %>
          <% if (application.postingLink) { %>
            <p><a href="<%= application.postingLink %>" target="_blank">View Job Posting</a></p>
          <% } %>
          <a href="/users/<%=user._id%>/applications/<%= application._id %>">View Details</a>
          <a href="/users/<%=user._id%>/applications/<%= application._id %>/edit">Edit</a>
          <form action="/users/<%=user._id%>/applications/<%= application._id %>?_method=DELETE" method="POST" style="display:inline;">
            <button type="submit" onclick="return confirm('Are you sure you want to delete this application?')">Delete</button>
          </form>
        </li>
      <% }); %>
    </ul>
  <% } %>
</body>
</html>